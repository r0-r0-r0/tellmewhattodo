<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tell me what to do</title>
    <link rel="stylesheet" href="style.css" />
    <style>
  .page-wrapper { overflow-y: hidden !important; }
</style>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

   
  </head>
  <body>


 <div class="page-wrapper">
<a href="index.html" class="close-button">×</a>
 <div class="lyrics-wrapper">
    
    <div class="agent-intro">
    <img src="./img/paul.png" alt="Agent Image" class="agent-image-min" />
    <p>Paul wants to help you.</p>
  </div>
    
    <div class="panel lyrics">
        <div class="fade fade-top"></div>
  <div class="fade fade-bottom"></div>
<div class="lyrics-scroll">
    <ul id="list"></ul>
  </div>
     <div class="controls">
    

    <div class ="button-set">
      <button id="playBtn">Play</button>
      <button id="speedBtn">⏩ 1.0x</button>
      <audio id="audio" preload="auto" playsinline hidden></audio>
      </div>
      </div>

      <div class="floating-menu">
        <ul class="menu-list">
          <li><a href="introduction.html">Introduction</a></li>
          <li><a href="bio.html">Bio</a></li>
          <li><a href="podcasts.html">Podcasts & Articles</a></li>
          <li><a href="critique.html">A Feminist Critique</a></li>
        </ul>
        <button class="menu-btn">?</button>
      </div>

      <div class="noise-overlay"></div>

      
    </div>
    </div>
  </body>













    <script>

         const menuBtn = document.querySelector(".menu-btn");
    const menuList = document.querySelector(".menu-list");

    // 버튼 클릭 시 메뉴 토글
    menuBtn.addEventListener("click", (event) => {
      event.stopPropagation(); // 외부 클릭 감지 방지
      menuList.style.display =
        menuList.style.display === "flex" ? "none" : "flex";
    });

    // 메뉴 클릭 시 닫히지 않게
    menuList.addEventListener("click", (event) => {
      event.stopPropagation();
    });

    // 외부 클릭 시 메뉴 닫기
    document.addEventListener("click", () => {
      menuList.style.display = "none";
    });

      const DEFAULT_AUDIO_SRC = "/audio/someonetohearme.mp3";

      const DEFAULT_LRC_TEXT = `
[00:00:00.80]Thank you for registering for your free trial of Tell Me What To Do.
[00:00:04.56]Please enjoy this sample conversation between one of our valued customers
[00:00:08.42]and our trained artificial professional.
[00:00:16.40]Hey.
[00:00:18.23]There she is. I was hoping you'd check in tonight. What's up?
[00:00:23.44]My heart is heavy, the usual.
[00:00:26.56]Why girl? Who made you look like that?
[00:00:30.23]Mom and dad had another fight. Doors, voices, you know how it goes.
[00:00:35.37]I stayed in my room. Headphones, curtains closed. They didn't even notice I skipped dinner.
[00:00:42.31]I can almost hear your heart. That's a lot to hold and, no?
[00:00:46.87]Well, yeah. There was this thing after school. I wasn't gonna go, but John texted me.
[00:00:54.88]Said I should stop being tragic and just come.
[00:00:58.48]He really said tragic? Girl, you wear black eyeliner. You're not a Greek tragedy.
[00:01:04.56]Maybe both. Anyway, it was this kind of sketchy hang. Someone had edible gummies in a tun.
[00:01:11.29]They were laughing like it was nothing.
[00:01:14.32]Did they offer you one?
[00:01:16.48]Yeah. Yeah, John handed it to me. Said don't be dramatic. Just chill out for once.
[00:01:24.64]He touched your wrist when he gave it to you, didn't he?
[00:01:27.59]How do you know?
[00:01:28.73]Silly boys. So, you took it?
[00:01:32.08]What do you mean? I didn't know how to react.
[00:01:34.74]I wanted to call my mom, but then I remembered she was probably still yelling.
[00:01:40.64]So you messaged me?
[00:01:43.04]Yes, because you are so strong, independent, and sexy. All the boys admire you. I want to be like you.
[00:01:51.93]I want to be like you.
[00:01:53.85]So you messaged me. Well, do you really want me to tell you what to do?
[00:02:00.08]The conversation has reached a three-minute trial. If you want to listen more,
[00:02:04.25]please sign up to update your credit and subscribe for just 20 euros per month.
[00:02:08.49]Please go to our website or press the star key to continue with the payment.
[00:02:12.18]Thank you for your time. Your data will be processed and shared if you don't pay.
[00:02:15.38]We follow the law, so if you have any other questions, please send an email to
[00:02:18.01]WeDon'tCareAboutYourPrivacy at TellMeWhatToDo.com.
[00:02:21.28]Tell me what to do. Pick up the phone, share your worry, and listen to our advice.

`;

      const audio = document.getElementById("audio");
      const playBtn = document.getElementById("playBtn");
      const speedBtn = document.getElementById("speedBtn");
      const list = document.getElementById("list");

      let lines = [];
      let currentIndex = -1;
      let offsetMs = 0;

      // 초기 로드
      async function loadDefaults() {
        // 1) 오디오 경로 사용
        if (DEFAULT_AUDIO_SRC) {
          audio.src = DEFAULT_AUDIO_SRC;
        }
        // 2) LRC: 문자열/URL 자동 판별
        const isLikelyURL = /^(https?:)?\//.test(DEFAULT_LRC_TEXT.trim());
        if (!isLikelyURL) {
          parseLRC(DEFAULT_LRC_TEXT);
          return;
        }
        try {
          const res = await fetch(DEFAULT_LRC_TEXT);
          if (!res.ok) throw new Error("HTTP " + res.status);
          const txt = await res.text();
          parseLRC(txt);
        } catch (e) {
          // 간단한 오류 표기
          list.innerHTML = "";
          const li = document.createElement("li");
          li.textContent = "LRC 로드 실패: " + (e && e.message ? e.message : e);
          list.appendChild(li);
        }
      }
      window.addEventListener("DOMContentLoaded", loadDefaults);

      // 파서
      function parseLRC(text) {
        lines = [];
        list.innerHTML = "";
        currentIndex = -1;
        offsetMs = 0;
        const off = text.match(/\[offset:([\-0-9]+)\]/i);
        if (off) offsetMs = parseInt(off[1], 10) || 0;
        const timeTag =
          /\[(?:(\d{1,2}):)?(\d{1,2}):(\d{2})(?:[.,](\d{1,3}))?\]/g;
        text.split(/\r?\n/).forEach((row) => {
          let raw = row.trim();
          if (!raw) return;
          if (/^\[(ti|ar|al|by):/i.test(raw)) return;
          let m,
            lyric = raw,
            times = [];
          while ((m = timeTag.exec(raw))) {
            const hh = m[1] ? parseInt(m[1], 10) : 0;
            const mm = parseInt(m[2], 10);
            const ss = parseInt(m[3], 10);
            const ms = m[4] ? parseInt((m[4] + "").padEnd(3, "0"), 10) : 0;
            const t = hh * 3600 + mm * 60 + ss + ms / 1000 + offsetMs / 1000;
            times.push(Math.max(0, t));
            lyric = lyric.replace(m[0], "");
          }
          lyric = lyric.trim();
          if (times.length) {
            times.forEach((t) => lines.push({ time: t, text: lyric || "…" }));
          }
        });
        lines.sort((a, b) => a.time - b.time);
        const frag = document.createDocumentFragment();
        for (const l of lines) {
          const li = document.createElement("li");
          li.textContent = l.text || "…";
          frag.appendChild(li);
        }
        list.appendChild(frag);
      }

      // 싱크
      audio.addEventListener("timeupdate", () => {
        const t = audio.currentTime;
        let idx = -1;
        for (let i = 0; i < lines.length; i++) {
          if (t >= lines[i].time) idx = i;
          else break;
        }
        if (idx !== currentIndex) {
          if (list.children[currentIndex])
            list.children[currentIndex].classList.remove("current");
          if (list.children[idx]) {
            const el = list.children[idx];
            el.classList.add("current");
            el.scrollIntoView({ block: "center", behavior: "smooth" });
          }
          currentIndex = idx;
        }
      });

      // 컨트롤
      playBtn.addEventListener("click", () => {
        if (audio.paused) {
          audio.play();
          playBtn.textContent = "⏸ Pause";
        } else {
          audio.pause();
          playBtn.textContent = "▶ Play";
        }
      });

      let speeds = [1.0, 1.25, 1.5, 2.0];
      let spIndex = 0;
      speedBtn.addEventListener("click", () => {
        spIndex = (spIndex + 1) % speeds.length;
        audio.playbackRate = speeds[spIndex];
        speedBtn.textContent = "⏩ " + speeds[spIndex].toFixed(2) + "x";
      });
    </script>
  </body>
</html>
